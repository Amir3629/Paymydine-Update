"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{1759:(t,e,n)=>{n.d(e,{S:()=>r});var a=n(49509);class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async detectTenant(){try{let t=await fetch("/api-server-multi-tenant.php/tenant-info"),e=await t.json();if(e.success)return this.tenantInfo=e.data,this.tenantInfo}catch(t){console.error("Failed to detect tenant:",t)}return null}getTenantInfo(){return this.tenantInfo}getApiBaseUrl(){{let t=a.env.NEXT_PUBLIC_API_BASE_URL||"",e="https:"===window.location.protocol,n=t.startsWith("http://localhost")||t.startsWith("http://127.0.0.1"),r=e&&t.startsWith("http:");return!t||n||r?"".concat(window.location.origin,"/api-server-multi-tenant.php"):t}}getTableUrl(t){return this.tenantInfo?this.tenantInfo.table_url_pattern.replace("{table_id}",t):"http://localhost:3001/table/".concat(t)}getFrontendUrl(){return this.tenantInfo?this.tenantInfo.frontend_url:"http://localhost:3001"}constructor(){this.tenantInfo=null}}},30098:(t,e,n)=>{n.d(e,{O:()=>d,u:()=>h});var a=n(67e3),r=n(1759);let o=a.U.getInstance(),s=o.getApiBaseUrl();o.getFrontendUrl();let i={success:!0,data:{items:[],categories:[]}},c={id:1,name:"Restaurant",address:"",city:"",state:"",telephone:"",description:""},l=r.S.getInstance();class d{async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(this.baseURL).concat(t),a={headers:{Accept:"application/json","Content-Type":"application/json",...e.headers},...e};try{let e=await fetch(n,a);if(!e.ok){let n=await e.text().catch(()=>"");throw Error("HTTP ".concat(e.status," ").concat(e.statusText," @ ").concat(t,": ").concat(n))}return await e.json()}catch(e){throw console.error("API request failed for ".concat(t,":"),e),e}}getApiBaseUrl(){return l.getApiBaseUrl()}async getMenu(){try{let t;let e=this.envConfig.getApiEndpoint("/menu");if(e.startsWith("http"))t=new URL(e);else{let n=window.location.origin;t=new URL(e,n)}t.searchParams.set("_t",Date.now().toString());let n=await fetch(t.toString());return await n.json()}catch(t){return console.error("Failed to fetch menu from API, using fallback:",t),i}}async getCategories(){try{let t=this.envConfig.getApiEndpoint("/categories"),e=await fetch(t);return await e.json()}catch(t){return console.log("Using fallback categories due to API error:",t),{success:!0,data:i.data.categories||[]}}}async getMenuItems(t){try{let e=(await this.getMenu()).data.items||[];return t&&(e=e.filter(e=>e.category_id===t)),{success:!0,data:e}}catch(t){return console.log("Using fallback menu items due to API error:",t),{success:!0,data:i.data.items||[]}}}async getPaymentMethods(){try{let t=this.envConfig.getApiEndpoint("/payments"),e=await fetch(t);if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let n=await e.json();if(!n.success||!Array.isArray(n.data))return[];return[...n.data].sort((t,e)=>t.priority-e.priority)}catch(t){return console.error("Failed to fetch payment methods:",t),[]}}async submitOrder(t){try{let e=this.envConfig.getApiEndpoint("/orders"),n=await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}catch(t){throw console.error("Order submission failed:",t),t}}async getUserOrders(t){try{let e=this.envConfig.getApiEndpoint("/user/".concat(t,"/orders")),n=await fetch(e);return await n.json()}catch(t){return console.log("User orders fetch failed:",t),{success:!0,data:[]}}}async getTableByQrCode(t){try{return{success:!0,data:{table_id:"7",table_name:"Table 7",restaurant_id:1}}}catch(t){return console.log("QR code processing failed:",t),{success:!1,message:"Invalid QR code"}}}async callWaiter(t,e){try{let n=this.envConfig.getApiEndpoint("/waiter-call"),a=String(null!=t?t:"").trim(),r=(null!=e?e:"").trim();if(!a)throw Error("Missing table_id");let o=await fetch(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({table_id:a,message:r})});if(!o.ok){let t="HTTP ".concat(o.status);try{let e=await o.json();(null==e?void 0:e.message)&&(t=e.message)}catch(t){}throw Error(t)}return await o.json()}catch(t){throw console.error("Waiter call failed:",t),t}}async callTableNote(t,e,n){let a={table_id:String(t),note:(null!=e?e:"").trim(),timestamp:null!=n?n:new Date().toISOString()};try{let t=this.envConfig.getApiEndpoint("/table-notes"),e=await fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)});if(!e.ok){let t=await e.text();throw Error("HTTP ".concat(e.status," ").concat(e.statusText,": ").concat(t))}return await e.json()}catch(t){throw console.error("Table note failed:",t),t}}async createValetRequest(t){try{let e=this.envConfig.getApiEndpoint("/valet-request"),n=JSON.stringify(Object.fromEntries(Object.entries(t).filter(t=>{let[,e]=t;return void 0!==e}))),a=await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:n});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}catch(t){throw console.error("Valet request failed:",t),t}}async getSettings(){try{let t=this.envConfig.getApiEndpoint("/settings"),e=await fetch(t);return await e.json()}catch(t){return console.log("Settings fetch failed:",t),{success:!0,data:{restaurant_name:"PayMyDine Restaurant",currency:"EUR",tax_rate:.19,service_charge:.1}}}}async getRestaurantInfo(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t=this.envConfig.getApiEndpoint("/restaurant"),e=await fetch(t);return await e.json()}catch(t){return console.log("Restaurant info fetch failed, using fallback:",t),{success:!0,data:c}}}async getOrderStatus(t){try{let e=this.envConfig.getApiEndpoint("/order-status?order_id=".concat(t)),n=await fetch(e);return await n.json()}catch(t){throw console.error("Order status fetch failed:",t),t}}async updateOrderStatus(t,e){try{let n=this.envConfig.getApiEndpoint("/order-status"),a=await fetch(n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({order_id:t,status_id:e})});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return await a.json()}catch(t){throw console.error("Order status update failed:",t),t}}async getTableInfo(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let a=new URLSearchParams;t&&(n?a.append("table_no",t):a.append("table_id",t)),e&&a.append("qr_code",e);let r=this.envConfig.getApiEndpoint("/table-info?".concat(a)),o=await fetch(r);return await o.json()}catch(t){return console.error("Table info fetch failed:",t),{success:!1,error:"Failed to fetch table information"}}}async getTableMenu(t,e){try{let n=new URLSearchParams;n.append("table_id",t),e&&n.append("location_id",e.toString());let a=this.envConfig.getApiEndpoint("/table-menu?".concat(n.toString())),r=await fetch(a);return await r.json()}catch(t){return console.log("Table menu fetch failed, using fallback:",t),i}}async getTableOrders(t){try{let e=this.envConfig.getApiEndpoint("/table-orders?table_id=".concat(t)),n=await fetch(e);return await n.json()}catch(t){return console.error("Table orders fetch failed:",t),{success:!1,error:"Failed to fetch table orders"}}}async getThemeSettings(){try{let t=window.location.origin,e=await fetch("".concat(t,"/simple-theme"),{headers:{Accept:"application/json"}});if(!e.ok)throw Error("HTTP ".concat(e.status));return await e.json()}catch(t){return console.error("Failed to fetch theme settings:",t),{success:!0,data:{theme_id:"clean-light",primary_color:"#E7CBA9",secondary_color:"#EFC7B1",accent_color:"#3B3B3B",background_color:"#FAFAFA"}}}}async updateThemeSettings(t){try{let e=this.envConfig.getApiEndpoint("/theme-settings"),n=await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}catch(t){return console.error("Failed to update theme settings:",t),{success:!1,message:"Failed to update theme settings"}}}async getTables(){try{let t=this.envConfig.getApiEndpoint("/tables"),e=await fetch(t);return await e.json()}catch(t){return{success:!1,error:"Failed to fetch tables"}}}async createTable(t){try{let e=this.envConfig.getApiEndpoint("/create-table"),n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await n.json()}catch(t){return{success:!1,error:"Failed to create table"}}}async updateTable(t,e){try{let n=this.envConfig.getApiEndpoint("/update-table"),a=await fetch(n,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({table_id:t,...e})});return await a.json()}catch(t){return{success:!1,error:"Failed to update table"}}}async deleteTable(t){try{let e=this.envConfig.getApiEndpoint("/delete-table?table_id=".concat(t)),n=await fetch(e,{method:"DELETE"});return await n.json()}catch(t){return{success:!1,error:"Failed to delete table"}}}async generateQRCode(t){try{let e=this.envConfig.getApiEndpoint("/generate-qr"),n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({table_id:t})});return await n.json()}catch(t){return{success:!1,error:"Failed to generate QR code"}}}async getTableStats(t){try{let e=this.envConfig.getApiEndpoint("/table-stats?table_id=".concat(t)),n=await fetch(e);return await n.json()}catch(t){return{success:!1,error:"Failed to fetch table stats"}}}constructor(t=s){this.baseURL=t,this.envConfig=a.U.getInstance()}}let h=new d},67e3:(t,e,n)=>{n.d(e,{U:()=>r});var a=n(49509);class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}detectEnvironment(){let t=window.location.hostname;if("localhost"===t||"127.0.0.1"===t)return{apiBaseUrl:a.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000",frontendUrl:a.env.NEXT_PUBLIC_FRONTEND_URL||"http://localhost:3000",wsUrl:a.env.NEXT_PUBLIC_WS_URL||"ws://localhost:8080",environment:"development",tenantDetection:!1,defaultTenant:"paymydine"};{let e=window.location.protocol,n=t||"paymydine.com";return{apiBaseUrl:"".concat(e,"//").concat(n),frontendUrl:"".concat(e,"//").concat(n),wsUrl:"".concat("https:"===e?"wss:":"ws:","//").concat(n),environment:"production",tenantDetection:!0,defaultTenant:"paymydine"}}}getConfig(){return this.config}getApiBaseUrl(){return this.config.apiBaseUrl}backendBaseUrl(){return this.config.apiBaseUrl}getFrontendUrl(){return this.config.frontendUrl}getWsUrl(){return this.config.wsUrl}isProduction(){return"production"===this.config.environment}isDevelopment(){return"development"===this.config.environment}shouldDetectTenant(){return this.config.tenantDetection}getDefaultTenant(){return this.config.defaultTenant}getApiEndpoint(t){return this.isProduction()&&this.shouldDetectTenant()?"/api/v1".concat(t):"".concat(this.getApiBaseUrl(),"/api/v1").concat(t)}constructor(){this.config=this.detectEnvironment()}}}}]);